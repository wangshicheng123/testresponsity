<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>è´ªåƒè›‡å°æ¸¸æˆ</title>
    <style>
        body,ul{
            margin: 0px;
            padding: 0px;
        }
        #container{
            background: #eee;
            width: 1000px;
            height: 700px;
            margin: 0px auto;
            /* ä¸ºäº†è§£å†³æ ‡é¢˜çš„ä¸Šè¾¹è·åˆå¹¶é—®é¢˜ï¼Œè§¦å‘BFCæ¨¡å¼*/
            overflow: hidden;
        }

        /* æ ‡é¢˜æ ·å¼ */
        .title h1{
            text-align: center;
            margin: 20px 0px;
            padding: 0px;
        }

        /* mapæ ·å¼ */
        .game-Container .map{
            background: #999;
            height: 500px;
            width: 500px;
            margin: 0px auto;
        }

        .game-Container .control-btn{
            width: 200px;
            height: 500px;
            /* background: red; */
            float: right;
            margin-right: 20px;
            border: 1px solid red;
        }
        .game-Container .btn-list{
            list-style: none;

        }
        .game-Container .btn-list li{
            border: 1px solid green;
            width: 80px;
            margin: 5px auto 20px auto;
            text-align: center;
            padding: 5px;
            border-radius: 5px;
        }
        .game-Container .btn-list li:not(.grade):hover{
            background: #ff0036;
            cursor: pointer;
        }

        .game-Container .infor{
            border: 1px solid red;
            border-radius: 5px;
            padding: 4px 3px;
            margin-bottom: 5px;
        }


        .default{
            background: green;
            width: 20px;
            height: 20px;
            float: left;
        }
        .active{
            background: blue;
            width: 20px;
            height: 20px;
            float: left;
        }
        .egg{
            background: red;
            width: 20px;
            height: 20px;
            float: left;
        }
    </style>
</head>
<body>
    <div id="container">
        <div class="title">
            <h1>è¿™æ˜¯ä¸€ä¸ªè´ªåƒè›‡æ¸¸æˆ</h1>
        </div>
        <div class="game-Container">
            <div class="control-btn">
                <ul class="btn-list">
                    <li class="grade">grade: <span id="grade">0</span></li>
                    <li id="start">start</li>
                    <li id="pause">pause</li>
                    <!-- <li id="continue">continue</li> -->
                    <li id="refresh">refresh</li>
                    <li id="speed">accelerate</li>
                </ul>
                <div class="egg-posi infor">egg-posi: x:<span id="egg-posi-x">0</span>; y=<span id="egg-posi-y">0</span>;</div>
                <div class="snake-head-posi infor">snak-posi: x:<span id="snake-x">0</span>; y=<span id="snake-y">2</span>;</div>
                <div class="snake-speed infor">snake-speed: <span id="snake-speed">300</span> ms/æ ¼</div>
                <div class="snake-length infor">snake-length: <span id="snake-length">3</span>æ ¼</div>
            </div>
            <div class="map" id="map"></div>
        </div>
        
    </div>
    <script>
        //è·å–æ•´ä¸ªåœ°å›¾å…ƒç´ 
        var oMap=document.getElementById("map");
        //è·å–gradeå…ƒç´ 
        var oGrade=document.getElementById("grade");
        //è·å–å¼€å§‹åŠŸèƒ½æŒ‰é’®å…ƒç´ 
        var oStart=document.getElementById("start");
        //è·å–æš‚åœåŠŸèƒ½æŒ‰é’®å…ƒç´ 
        var oPause=document.getElementById("pause");

        //è·å–ç»§ç»­åŠŸèƒ½æŒ‰é’®å…ƒç´ 
        // var oContinue=document.getElementById("continue");
        
        //è·å–åˆ·æ–°åŠŸèƒ½æŒ‰é’®å…ƒç´ 
        var oRefresh=document.getElementById("refresh");
        //è·å–åŠ é€ŸåŠŸèƒ½æŒ‰é’®å…ƒç´ 
        var oAccelerate=document.getElementById("speed");

        //è·å–éšæœºäº§ç”ŸğŸ¥šçš„xä½ç½®çš„å…ƒç´ 
        var oEggPosiX=document.getElementById("egg-posi-x");
        //è·å–éšæœºäº§ç”ŸğŸ¥šçš„yä½ç½®çš„å…ƒç´ 
        var oEggPosiY=document.getElementById("egg-posi-y");
        //è·å–ğŸå¤´çš„ä½ç½®xçš„å…ƒç´ 
        var oSnakeHeadPosiX=document.getElementById("snake-x");
        //è·å–ğŸå¤´çš„ä½ç½®yçš„å…ƒç´ 
        var oSnakeHeadPosiY=document.getElementById("snake-y");
        //è·å–ğŸçš„é€Ÿåº¦çš„å…ƒç´ 
        var oSnakeSpeed=document.getElementById("snake-speed");
        //è·å–ğŸçš„å½“å‰é•¿åº¦
        var oSnakeLength=document.getElementById("snake-length");
        



        //å®šä¹‰ä¸€ä¸ªğŸç§»åŠ¨çš„å®šæ—¶å™¨
        var moveTimer;

        //å®šä¹‰ä¸€ä¸ªæ”¹å˜ğŸçš„ç§»åŠ¨é€Ÿåº¦çš„å…¨å±€å˜é‡(å•ä½æ˜¯æ¯«ç§’)
        var moveSpeed=300;

        //å®šä¹‰ä¸€ä¸ªå˜é‡ç”¨æ¥è®°å½•åˆ†æ•°
        var grade=0;

        //å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨æ¥è®°å½•æ¸¸æˆæ˜¯å¦å¼€å§‹è¿˜æ˜¯ç»“æŸ
        var isStart=false;

        //å®šä¹‰x_eggå’Œy_eggä¸¤ä¸ªå˜é‡æ¥è®°å½•è›‹çš„ä½ç½®
        var x_egg=0;
        var y_egg=0;

        //å®šä¹‰ä¸€ä¸ªdirectionå˜é‡ç”¨æ¥è®°å½•ğŸå…·ä½“è¦ç§»åŠ¨çš„æ–¹å‘
        var direction="right";

        //åˆ›å»ºè›‡æ¨¡å‹éƒ¨åˆ†
        //å®šä¹‰ä¸€ä¸ªå˜é‡å­˜å‚¨è›‡çš„èµ·å§‹é•¿åº¦
        var snakeLength=3;
        //å®šä¹‰è›‡å¤´çš„èµ·å§‹ä½ç½®åç§»é‡(æ³¨æ„æ˜¯ä»0å¼€å§‹çš„)
        var x_snake=0;
        var y_snake=2;

        //å®šä¹‰ä¸€ä¸ªä¸€ç»´æ•°ç»„ç”¨æ¥å­˜å‚¨è›‡èº«çš„æ¯ä¸€ä¸ªå°div
        var snakeArray=[];

        //è®¾ç½®åœ°å›¾ä¸­ä¸€åˆ—æœ‰å°æ–¹å—çš„ä¸ªæ•°
        var columnNumber=25;
        //è®¾ç½®åœ°å›¾ä¸­ä¸€è¡Œæœ‰å°æ–¹å—çš„ä¸ªæ•°
        var rowNumber=25;
        //è®¾ç½®æ¯ä¸ªå°æ ¼å­çš„å®½é«˜
        var cellWidth=20;
        var cellHeight=20;

        //åŠ¨æ€è®¾ç½®åœ°å›¾çš„å®½å’Œé«˜(æ¯ä¸ªå°æ–¹å—çš„å®½å’Œé«˜éƒ½æ˜¯20px)
        var mapWidth=rowNumber*cellWidth+"px";
        var mapHeight=columnNumber*cellHeight+"px";
        oMap.style.height=mapHeight;
        oMap.style.width=mapWidth;

        //é€šè¿‡ä¸€ä¸ªäºŒç»´æ•°ç»„snakeDivPositionç”¨æ¥è®°å½•mapä¸Šé¢æ‰€æœ‰çš„å°æ–¹æ ¼çš„ä½ç½®
        var snakeDivPosition=[];
        for(var i=0; i<columnNumber; ++i){

            var rowArray=[];
            //æ–°åˆ›å»ºä¸€ä¸ªè¡Œçš„divç”¨æ¥ç››æ”¾æ¯ä¸€è¡Œçš„å°div
            var rowDiv=document.createElement("div");
            oMap.appendChild(rowDiv);
            
            //forå¾ªç¯ç”¨æ¥ç”Ÿæˆæ¯ä¸€è¡Œçš„å°divå…ƒç´ 
            for(var j=0; j<rowNumber; ++j){

                //æ–°åˆ›å»ºæ¯ä¸€è¡Œä¸­çš„å°div
                var columnDiv=document.createElement("div");
                columnDiv.className="default";
                //æŠŠæ–°åˆ›å»ºçš„æ¯ä¸ªå°divæ·»åŠ åˆ°å¤§çš„è¡Œdivå†…éƒ¨
                rowDiv.appendChild(columnDiv);
                //æŠŠå°divæ·»åŠ åˆ°è¡Œæ•°ç»„å†…éƒ¨
                rowArray.push(columnDiv);
            }
            snakeDivPosition.push(rowArray);
        }


        //æ·»åŠ é”®ç›˜ç›‘å¬äº‹ä»¶ç”¨æ¥æ”¹å˜ğŸ çš„ç§»åŠ¨æ–¹å‘
        document.onkeydown=function(e){

            var e1 =e||window.event;
            if(direction=="top"&&e1.keyCode==40){
                return;
            }
            if(direction=="left"&&e1.keyCode==39){
                return;
            }
            if(direction=="bottom"&&e1.keyCode==38){
                return;
            }
            if(direction=="right"&&e1.keyCode==37){
                return;
            }

            if(direction=="top"&&e1.keyCode==38){
                return;
            }
            if(direction=="bottom"&&e1.keyCode==40){
                return;
            }
            if(direction=="left"&&e1.keyCode==37){
                return;
            }
            if(direction=="right"&&e1.keyCode==39){
                return;
            }
            switch(e1.keyCode){
                case 38:
                    direction="top"; 
                    return;
                case 40:
                    direction="bottom";
                    return;
                case 37:
                    direction="left";
                    return;
                case 39:
                    direction="right";
                    return;
            }
        }

        //æ•°æ®åˆå§‹åŒ–ç½®é›¶å‡½æ•°
        function startData(){
            moveSpeed=300;
            grade=0;
            isStart=true;
            x_egg=0;
            y_egg=0;
            direction="right";
            snakeLength=3;
            x_snake=0;
            y_snake=2;
            //ä½¿ç”¨forå¾ªç¯æ¥åˆ›å»ºè›‡èº«
            for(var i=0; i<snakeLength; ++i){
                //
                snakeArray[i]=snakeDivPosition[0][i];
                //ç»™è›‡èº«æ¢æˆä¸åŒçš„æ ·å¼ï¼ŒåŠ ä»¥åŒºåˆ†
                snakeArray[i].className="active";
            }
        }

        //è®¾ç½®ğŸçš„ç§»åŠ¨é€»è¾‘çš„å‡½æ•°
        function snakeMove(){
            //é€šè¿‡directionå»åˆ¤æ–­ğŸè¦ç§»åŠ¨çš„æ–¹å‘ï¼Œä»è€Œæ”¹å˜ğŸå¤´çš„åç§»é‡
            switch(direction){
                case "right":
                    y_snake++;
                    break;
                case "left":
                    y_snake--;
                    break;
                case "top":
                    x_snake--;
                    break;
                case "bottom":
                    x_snake++;
                    break;
            }
            //åˆ¤æ–­ğŸå¤´æ˜¯å¦è¶Šç•Œ
            if(x_snake==-1||x_snake==rowNumber||y_snake==-1||y_snake==columnNumber){
                alert("å¾ˆé—æ†¾ï¼Œæ‚¨å¤±è´¥äº†ï¼è¶Šç•Œ,è¯·refreshé‡è¯•");
                //æ­¤å¤„è¦æ¸…é™¤å®šæ—¶å™¨å¹¶ç»“æŸç¨‹åº
                clearInterval(moveTimer);
                isStart=false;
                return;
            }

            //å¦‚æœğŸåƒåˆ°è‡ªå·±ä¹Ÿè¦ç»“æŸæ¸¸æˆï¼Œåˆ¤æ–­æ˜¯å¦åƒåˆ°è‡ªå·±
            for(var i=0; i<snakeArray.length; ++i){
                if(snakeArray[i]==snakeDivPosition[x_snake][y_snake]){
                    alert("å¾ˆé—æ†¾ï¼Œæ‚¨å¤±è´¥äº†ï¼åƒåˆ°è‡ªå·±,è¯·refreshé‡è¯•");
                    //æ­¤å¤„è¦æ¸…é™¤å®šæ—¶å™¨å¹¶ç»“æŸç¨‹åº
                    clearInterval(moveTimer);
                    isStart=false;
                    return;
                }
            }

            //åˆ¤æ–­ğŸæ˜¯å¦åƒåˆ°ğŸ¥šï¼Œå¦‚æœè¿Ÿåˆ°æ€ä¹ˆå¤„ç†ï¼Œæ²¡åƒåˆ°æ€ä¹ˆå¤„ç†
            if(x_snake==x_egg&&y_snake==y_egg){

                //åœ¨ç»„æˆğŸçš„æ•°ç»„(snakeArray)ä¸­çš„å°¾éƒ¨æ·»åŠ ä¸€ä¸ªå…ƒç´ 
                snakeDivPosition[x_snake][y_snake].className="active";
                //åœ¨å­˜æ”¾ğŸçš„å…ƒç´ çš„æ•°ç»„çš„å°¾éƒ¨æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼ˆè¿™ä¸ªä½ç½®æœ‰ğŸ¥šï¼‰
                snakeArray.push(snakeDivPosition[x_snake][y_snake]);    

                //åƒåˆ°ğŸ¥šåä½¿åˆ†æ•°åŠ ä¸€
                oGrade.innerHTML=++grade;

                //ç„¶åå†éšæœºäº§ç”Ÿä¸€ä¸ªğŸ¥š,ç»§ç»­è¿›è¡Œæ¸¸æˆ
                createNewEgg();
                oSnakeLength.innerHTML=++snakeLength;


            }else{
                //åœ¨ç»„æˆğŸçš„æ•°ç»„(snakeArray)ä¸­çš„å°¾éƒ¨æ·»åŠ ä¸€ä¸ªå…ƒç´ 
                snakeDivPosition[x_snake][y_snake].className="active";
                //åœ¨å­˜æ”¾ğŸçš„å…ƒç´ çš„æ•°ç»„çš„å°¾éƒ¨æ·»åŠ ä¸€ä¸ªå…ƒç´ 
                snakeArray.push(snakeDivPosition[x_snake][y_snake]);    

                //æ²¡æœ‰åƒåˆ°ğŸ¥šï¼ŒæŠŠå­˜æ”¾ğŸçš„æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ ·å¼è®¾ä¸ºé»˜è®¤æ ·å¼ï¼Œå¹¶ä¸”ä»æ•°ç»„ä¸­åˆ é™¤
                snakeArray[0].className="default";
                snakeArray.shift();
                console.log("x_egg:"+x_egg+"y_egg:"+y_egg);
            }
        }


        //å®šä¹‰ä¸€ä¸ªå®šæ—¶å™¨ï¼Œä½¿ğŸç§»åŠ¨çš„å‡½æ•°åœ¨ä¸€å®šé—´éš”çš„æ—¶é—´å†…ä¸æ–­æ‰§è¡Œ
        function run(speed){
            moveTimer=setInterval(function(){
                // console.log(direction);
                // console.log(x_snake,y_snake);
                snakeMove();
                oSnakeHeadPosiX.innerHTML=x_snake;
                oSnakeHeadPosiY.innerHTML=y_snake;
                oSnakeSpeed.innerHTML=speed;
                console.log(isStart);
            },speed);
        }

        //å®šä¹‰ä¸€ä¸ªäº§ç”Ÿ0---columnNumberå’Œ0---rowNmuberä¹‹é—´çš„éšæœºæ•°çš„å‡½æ•°
        function random(min,max){
            return Math.floor(Math.random()*(max-min))+min;
        }

        //éšæœºäº§ç”ŸğŸ¥šçš„å‡½æ•°
        function createNewEgg(){
            //éšæœºäº§ç”ŸğŸ¥šçš„ä½ç½®
            x_egg=random(0,25);
            y_egg=random(0,25);

            //ä½¿ç”¨å¾ªç¯æ¥åˆ¤æ–­é¸¡è›‹æ˜¯å¦å’Œå½“å‰çš„ğŸèº«é‡åˆ,è‹¥é‡åˆåœ¨ç”Ÿæˆä¸€ä¸ªğŸ¥š
            for(var i=0; i<snakeArray.length; ++i){
                if(snakeDivPosition[x_egg][y_egg]==snakeArray[i]){
                    createNewEgg();
                }
            }
            //æ˜¯å½“å‰ğŸ¥šçš„æ ·å¼è¿›è¡Œæ”¹å˜
            snakeDivPosition[x_egg][y_egg].className="egg"
            oEggPosiX.innerHTML=x_egg;
            oEggPosiY.innerHTML=y_egg;
        }

        //å¼€å§‹åŠŸèƒ½æŒ‰é’®çš„åˆ¶ä½œ
        oStart.onclick=function(){
            if(!isStart){

                //è°ƒç”¨æ¸¸æˆå¼€å§‹æ•°æ®åˆå§‹åŒ–å‡½æ•°
                startData();

                //åˆå§‹äº§ç”Ÿçš„ğŸ¥š,æ³¨æ„è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„ä½ç½®ï¼Œåœ¨ä¸Šé¢çš„å˜é‡å®šä¹‰ä¹‹å
                createNewEgg();

                //æ³¨æ„è¦æ¸…é™¤ä»¥å‰çš„å®šæ—¶å™¨
                clearInterval(moveTimer);

                //åœ¨é‡æ–°å¼€å§‹çš„æ—¶å€™
                //å¯ä»¥è°ƒç”¨ä¸€ä¸ªç½®é›¶å‡½æ•°

                //è°ƒç”¨å®šæ—¶å™¨å‡½æ•°æ˜¯ğŸä¸æ–­åœ°è¿åŠ¨
                run(moveSpeed);
            }
        }

        //å¼€å§‹æš‚åœ/ç»§ç»­åŠŸèƒ½æŒ‰é’®çš„åˆ¶ä½œ
        var isPause=false;
        oPause.onclick=function(){
            if(isStart){
                if(!isPause){

                    //æ¸…é™¤å®šæ—¶å™¨ï¼Œå³å¯ç»“æŸğŸçš„è¿åŠ¨
                    clearInterval(moveTimer);
                    // isStart=false;
                    isPause=true;
                    oPause.innerHTML="continue";
                }else{

                    // isStart=true;
                    isPause=false;
                    run(moveSpeed);
                    oPause.innerHTML="pause";
                }
            }
        }

        //å¼€å§‹åˆ¶ä½œåˆ·æ–°æŒ‰é’®
        oRefresh.onclick=function(){
            window.location.reload();
        }

        //å¼€å§‹åˆ¶ä½œåŠ é€ŸæŒ‰é’®åŠŸèƒ½
        oAccelerate.onclick=function(){
            if(isStart){
                moveSpeed-=20;
                clearInterval(moveTimer);
                run(moveSpeed);
            }
        }

 

    </script>
</body>
</html>